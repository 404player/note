## 小迪信安课程笔记

### 实战基于WEB和端口结合的渗透案例

在目标网站上发现不了情况，可以使用`nmap`扫描端口（使用全部端口扫描），获取所有TCP的端口。在其他端口可能存在服务，可以进行测试。（域名：端口）

在这个基础上（端口对应的不是一个站点），可以进行目录扫描，看看能不能找到其他服务。

### 实战基于WEB目录结构上的渗透案例

案例：本站点`xiaodi.com`中找不到漏洞，通过目录扫描发现有`xiaodi.com/old`的`url`存在，可能存在**旧的网站源码、网站的其他服务**。

当对主站渗透暂时没有头绪的时候，通过使用工具对网站进行目录扫描，找到目录下其他服务或者源码，进行进一步的渗透。（审计或者通过对旁站的权限获取进而对主站点进行渗透）

### 实战基于WEB域名结构上的渗透实例

使用工具或者浏览器进行多级域名的挖掘。

挖掘出来的域名解析出来的地址要是同一个`IP`，则是同一台服务器。要是同网段，可以拿下权限后再进行内网渗透完成对主域名的渗透。要是都不同，也可以挖掘出一些域相关的信息。

### 实战基于中间件平台漏洞的渗透实例

通过探测中间件的类型和版本，针对相应类型和版本中间件漏洞进行渗透。

典型的中间件漏洞可以通过扫描器扫出来，比较新的漏洞可以通过查找资料找到相应的方法进行渗透。

资料：[Web中间件常见漏洞总结](https://www.lxhsec.com/2019/03/04/middleware/)

### 实战基于第三方软件漏洞的渗透实例

基于端口扫描，通过端口协议判断第三方软件的服务。

通过开放的端口猜解服务器上有什么第三方软件的服务。（比如`ftp`服务，通过第三方软件搭建的话，如果第三方软件有漏洞，也是一个突破口。信息收集的时候也要对这方面做相应的收集）。

收集到第三方软件的信息后，可以通过搜索引擎去找到相关软件的漏洞及其`exp`，进行进一步的渗透。

 ### 急于服务器系统漏洞的渗透实例

利用较专业的系统扫描工具进行扫描，比如`nessus`和`openvas`两款工具。		

扫描出来的漏洞可以进一步通过搜索引擎了解信息（或者看看`metasploit`框架能不能直接利用）。也可以去`github`上找相应的`exp`或者利用工具。

### 信息收集

#### WEB信息收集

- 网站源码脚本

  伪静态： 不是真正意义上的静态文件格式， 表面上看是`html`页面，实际上是利用动态脚本来处理的

  可以通过填入一些数据提交，查看数据包，看到网站的处理脚本格式，后期在目录扫描的时候选择格式的时候要根据收集到的信息来选取(`login.php`)

  如果直接显示的话，就直接用后缀名扫（`index.php`）

- 网站搭建平台信息

  通过查看元素或审查元素抓包获取

- 网站对应数据库

  常用的组合匹配： 如`php`程序，判定`mysql`；如`aspx`，判定`mssql`

  常用组合：`asp + access`   `php + mysql`  `aspx + mssql`  `jsp + mssql或 oracle`

  端口扫描判定： 内网服务器失效（外网扫描内网扫到的是内网映射出来外网的信息）

  常用数据库端口： `access`——无端口开放  `mysql`——3306 `mssql`——1433   `oracle`——1521

  参考文章：[端口渗透总结](https://www.cnblogs.com/botoo/p/10475402.html)

- 服务器操作系统

  `windows`大小写不敏感  `Linux`大小写敏感   可以通过将`url`某部分改成大写来判定

- `robots`协议

  直接访问地址`/robots.txt`获取相关目录地址信息

  `robots.txt`协议规定目录文件是否会被搜索引擎爬取到

  有可能会出现一些敏感文件， 比如说后台地址

- WEB指纹识别

  网站使用什么`CMS`搭建的

  常见平台： `whatweb`、 云悉

  常见工具：`cmsmap`、御剑（不建议经常使用，因为不常更新）

#### 端口信息收集

- 工具： `nmap`、 `masscan`

- WEB对应端口

  举例：`www.xiaodi8.com`  `zblog`搭建

  ​		  `www.xiaodi8.com:8080`  `discuz`搭建

    		相当于两个目标，攻击面更大

- 服务协议对应

  通过扫描端口对应服务，然后使用相应的攻击方式尝试渗透

  参考文章：[端口渗透总结](https://www.cnblogs.com/botoo/p/10475402.html)

#### 域名信息收集

- 子域名

  有可能子域名和主域名在同网段或同`IP`

  工具： `layer  子域名挖掘机`、 `inurl:baidu.com`

#### 目录信息收集

- 敏感文件 （`7kbscan-WebPathBrute`)

  `WebPathBrute`会根据域名自行生成字典

  备份文件： 数据库备份文件、 源码备份文件等

  说明文件： 源码说明、 其他说明

- 目录站点

  `www.xiaodi8.com` 使用`zblog`搭建

  `www.xiaodi0.com/bbs` 使用`discuz`搭建

- 爬行目录

  通过扫描工具爬行整个WEB目录结构 其中可能包括后台地址等

- 扫描目录

  通过字典扫描工具扫描存在的目录

#### 其他信息收集

- 第三方接口信息

  站长之家查询一下有关站点的一些其他信息，方便生成字典等等

- 有无`CDN`服务

  工具： 超级`ping`（借用全国各地的机器去ping)

  对测试造成干扰，对`CDN`服务的网站，测试的会是一个缓存。所以成功测试的前提是得到网站的真实地址

- 有无`WAF`防护

  分硬件和软件

  工具： `wafw00f`

  命令行： `python main.py url`

- 有无其他运用

  `APP` 或者 手机站点 第三方接口

- `IP`网段网络信息

  域名解析可能解析到`IP` 下的某个目录，但是使用`IP`进行扫描会在根目录下进行扫描， 覆盖面会更大， 多了一种扫描的深度

  网段: C段信息扫描  网段 192.168.1.1 - 192.168.1.254   工具： 在线C段查询

  工具： `IISput 增强版`

  
### 漏洞发现












